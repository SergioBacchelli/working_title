# UI_FIELD_FORMAT — типы полей и формат параметров

Этот документ описывает, **как** заполнять таблицу полей в UI-спеке.

## 1) Таблица полей: рекомендуемые колонки

Базовый вариант:

| PanelId | FieldKeyEn | DisplayNameRu | Type | Required | Default | Params |
|---|---|---|---|---:|---|---|

Расшифровка:
- `PanelId` — в какой панели лежит поле.
- `FieldKeyEn` — стабильный ключ поля (идентификатор). Используется:
  - в UI (внутренние ключи состояния),
  - в Core/Logic (сопоставление входов/выходов),
  - в Storage (см. `DECISIONS.md` → D-005).
- `DisplayNameRu` — подпись для пользователя (человеческое имя поля).
- `Type` — тип управления (см. раздел 2).
- `Required` — обязательность (`да/нет`).
- `Default` — значение по умолчанию (если нет — ставим `-`).
- `Params` — дополнительные параметры: варианты, валидация, форматирование, подсказки.

## 2) Поддерживаемые типы полей (Type)

Минимальный набор на старте:

- `text` — строка (однострочный ввод).
- `number` — число.
- `select` — выпадающий список (выбор одного значения).
- `radio` — радиокнопки (выбор одного значения).
- `checkbox` — да/нет (галочка).
- `toggle` — да/нет (переключатель; логика как у checkbox).
- `readonly` — поле только для отображения (результат, не редактируется).

Дополнительно (по необходимости):
- `textarea` — многострочный текст.
- `multiselect` — выбор нескольких значений.
- `file` — выбор/загрузка файла (если появится такой сценарий).

## 3) Формат колонки Params

`Params` — это строка из пар `КЛЮЧ:ЗНАЧЕНИЕ`, разделённых `;`.

Пример:
`UNIT:mm; MIN:0; MAX:3000; STEP:1; HELP:Введите в миллиметрах`

Правила:
- Ключи — в UPPER_SNAKE или UPPER (пример: `OPTIONS`, `MIN`, `FORMAT`).
- Значения — без ограничений, но лучше коротко.
- Если значение содержит `;`, лучше не использовать его (или экранировать — но пока проще «не надо»).

## 4) Поля со списком: select / radio

### 4.1 OPTIONS

Для `select` и `radio` используем параметр:

`OPTIONS: value1=Label1; value2=Label2; value3=Label3`

Где:
- `valueX` — **внутреннее значение**, которое сохраняется в данные (в Storage пишем именно его).
- `LabelX` — подпись для пользователя в UI.

Рекомендация: внутренние значения делать ASCII (латиница/цифры/подчёркивание), чтобы не ловить сюрпризы при сериализации.

### 4.2 LAYOUT (только для radio)

Для `radio` можно указать раскладку:

`LAYOUT:horizontal` или `LAYOUT:vertical`

Если не указано — UI выбирает сам.

## 5) Поля да/нет: checkbox / toggle

Используем `Default: true/false` и (опционально) подписи:

`TRUE_LABEL:Да; FALSE_LABEL:Нет`

Если подписи не нужны — не пишем.

## 6) Readonly (вывод без редактирования)

Для `readonly` обычно добавляем, чем и как оно отображается:

- `FORMAT:<что-то>` — формат отображения (пример: `FORMAT:currency`, `FORMAT:integer`, `FORMAT:mm`).
- `SOURCE:<fieldKeyEn>` — откуда берётся (если это прямое отображение другого ключа/расчёта).
  - Если вывод вычисляется напрямую модулем и кладётся в поле результата — `SOURCE` можно не указывать.

Пример:
`FORMAT:currency; HELP:Рассчитано модулем`

## 7) Валидация (если нужно)

Минимальные универсальные параметры:

- `MIN:<number>` / `MAX:<number>` — диапазон (для number).
- `STEP:<number>` — шаг.
- `LEN_MIN:<number>` / `LEN_MAX:<number>` — длина строки (для text/textarea).
- `PATTERN:<regex>` — регулярка (для text).
- `REQUIRED_IF:<условие>` — условная обязательность (на старте можно не использовать, но формат зарезервирован).

Пример:
`MIN:100; MAX:2600; STEP:1; UNIT:mm`

## 8) Связь со Storage (важно)

Если модуль сохраняет/загружает данные, то значение, которое попадает в файл, должно быть **стабильным**:
- для `select/radio` пишем **внутреннее значение** (`value`), а не русскую подпись;
- для `checkbox/toggle` пишем `true/false`;
- для `number` — число (без единиц измерения; единицы живут в `Params`).

Формат строки данных см. `DECISIONS.md` → D-005:
`<FieldKeyEn>_(Display:<FieldNameRuNoSpaces>)_<Value>`
